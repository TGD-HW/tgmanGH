<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TG Motion: G-code extensions</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../TG_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TG Motion
   &#160;<span id="projectnumber">version 502 - 4034/906 cnc 126</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d4/d53/group___parametric_programming.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">G-code extensions</div>  </div>
</div><!--header-->
<div class="contents">
<p>TG Motion uses several G-code extensions to simplify G-code programming.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Parametric programming</h2>
<p>There are 100 parameters (P00 - P99) which can be used instead of fixed numerical values in any G-code address. All the values are expressed as floating point values with precision of 15-17 digits (float64_t precision).<br  />
 During G-code execution system uses the value stored in the parameter. Before use, the value should be defined in an assignment. </p><div class="fragment"><div class="line">P37 = 10 + 25 * SIN(45)</div>
<div class="line">G0  X 10  Z P37</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Because the parameters are marked as Pxx, the address P is reserved and can be used ONLY for parameters.</dd></dl>
<h2><a class="anchor" id="autotoc_md5"></a>
Mathematic expressions</h2>
<p>Mathematic expression can contain:</p><ul>
<li>numbers and/or parameters (P00 - P99)</li>
<li>mathematic operations<ul>
<li>addition <b>+</b> </li>
<li>subtraction <b>-</b> </li>
<li>multiplication <b>*</b> </li>
<li>division <b>/</b> </li>
<li>modulo <b>%</b> </li>
<li>power of <b>^</b> </li>
</ul>
</li>
<li>mathematic functions (names are case insensitive)<ul>
<li>SIN(angle) - sinus, <code>angle</code> is in degrees</li>
<li>COS(angle) - cosines, <code>angle</code> is in degrees</li>
<li>TAN(angle) - tangens, <code>angle</code> is in degrees</li>
<li>ASIN(val) - arcus sinus</li>
<li>ACOS(val) - arcus cosines</li>
<li>ATAN(val) - arcus tangens</li>
<li>ATAN2(y, x) - arcus tangens of opposite leg to adjacent leg of a triangle</li>
<li>ABS(val) - absolute value</li>
<li>FABS(val) - absolute value</li>
<li>SQRT(val) - square root</li>
<li>LOG10(val) - logarithm of base 10</li>
<li>LOG(val) - natural logarithm</li>
<li>HYPOT(a, b) - SQRT(a*a + b*b)</li>
<li>PI() - pi number 3.1415926....</li>
<li>FLOOR(val) - nearest lower integer value of <code>val</code> </li>
<li>CEIL(val) - nearest higher integer value of <code>val</code> </li>
<li>ReadPLCLong(address) - read integer value from PLC memory at <code>address</code> (note address must be &gt; 0)</li>
<li>ReadPLCDouble(address) - read float64_t floating point value from PLC memory at <code>address</code> (note address must be &gt; 0)</li>
<li>WritePLCLong(address, arg) - write <code>arg</code> as integer value to PLC memory at <code>address</code> (note address must be &gt; 0). Note that WritePLCLong must be on the right side of an assignment. It returns the previous value in the PLC memory. <div class="fragment"><div class="line">P1 = WritePLCLong(1024, P2)</div>
</div><!-- fragment --></li>
<li>WritePLCDouble(address, arg) - write <code>arg</code> as float64_t floating point value to PLC memory at <code>address</code> (note address must be &gt; 0). Must be on the right side of an assignment.</li>
</ul>
</li>
<li>brackets () which can modify/clarify the priority of mathematical operations</li>
</ul>
<p>Expressions can be entered directly after the address letter: </p><div class="fragment"><div class="line">G0  X P21+P22  Z P23</div>
</div><!-- fragment --><p> Or as an assignment to a parameter: </p><div class="fragment"><div class="line">P1 = ReadPLCDouble(1024) + SIN(ABS(ReadPLCLong(2048)))</div>
<div class="line">G1 X P1</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Priority of operations</h2>
<ol type="1">
<li>brackets</li>
<li>mathematic functions</li>
<li>power of <b>^</b> </li>
<li>multiplication and division <b>*</b> <b>/</b> </li>
<li>addition and subtraction <b>+</b> <b>-</b> </li>
</ol>
<h2><a class="anchor" id="autotoc_md7"></a>
Subroutines and labels</h2>
<p>Any block of G-code text can act as a subroutine. Subroutine starts with a label or line number and ends with <code>M17</code> or <code>RETURN</code>. The label is text in the begin of <code>G29</code> comment function or can be declared independently on a separate line, then it must end with colon <code></code>: <br  />
 Functions <code>G25</code>, <code>G26</code> or keyword <code>CALL</code> can be used to call the subroutine. Subroutines must be in the same G-code file as their call(s). </p><div class="fragment"><div class="line">G1 X... Y...</div>
<div class="line">CALL Subroutine1</div>
<div class="line">...</div>
<div class="line">M2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">G29 Subroutine1</div>
<div class="line">G2 X... Y... I... J...</div>
<div class="line">...</div>
<div class="line">RETURN</div>
</div><!-- fragment --><p>The same meaning with independent label:</p>
<div class="fragment"><div class="line">G1 X... Y...</div>
<div class="line">CALL Subroutine1</div>
<div class="line">...</div>
<div class="line">M2</div>
<div class="line"> </div>
<div class="line">Subroutine1:</div>
<div class="line">G2 X... Y... I... J...</div>
<div class="line">...</div>
<div class="line">RETURN</div>
</div><!-- fragment --><p>Using line number N:</p>
<div class="fragment"><div class="line">G1 X... Y...</div>
<div class="line">G25 L 1000</div>
<div class="line">...</div>
<div class="line">M2</div>
<div class="line"> </div>
<div class="line">N 1000 G2 X... Y... I... J...</div>
<div class="line">...</div>
<div class="line">RETURN</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Loops</h2>
<p>There are two loop program constructs available: <code>FOR</code> loop and <code>WHILE</code> loop.<br  />
 <code>FOR</code> loop syntax is:<br  />
 <code>FOR</code> initial_value <code>TO</code> end_value [<code>STEP</code> step_value] <br  />
 &#160; ... loop body <br  />
 <code>END</code> <br  />
 <br  />
 Example: </p><div class="fragment"><div class="line">P2 = -10 <span class="comment">// end Z coord</span></div>
<div class="line">P3 = 2   <span class="comment">// safe Z coord</span></div>
<div class="line">FOR P1 = 0 TO P2 STEP -1</div>
<div class="line">  G1  Z P1</div>
<div class="line">  G0  Z P3</div>
<div class="line">END</div>
</div><!-- fragment --><p> Every <code>FOR</code> loop must end with keyword <code>END</code>. <br  />
 <br  />
 <code>WHILE</code> loop syntax is:<br  />
 <code>WHILE</code> condition<br  />
 &#160; .. loop body<br  />
 <code>END</code> <br  />
 <br  />
 Example: </p><div class="fragment"><div class="line">P1 = 0   <span class="comment">// actual Z coord</span></div>
<div class="line">P2 = -10 <span class="comment">// end Z coord</span></div>
<div class="line">P3 = 2   <span class="comment">// safe Z coord</span></div>
<div class="line">WHILE P1 &gt; P2</div>
<div class="line">  G1  Z P1</div>
<div class="line">  G0  Z P3</div>
<div class="line">  P1 = P1-1</div>
<div class="line">END</div>
<div class="line">G1  Z P2</div>
<div class="line">G0  Z P3</div>
<div class="line">END</div>
</div><!-- fragment --><p>The <code>condition</code> could be: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Symbol   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">&gt;   </td><td class="markdownTableBodyNone">Greater than    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">&lt;   </td><td class="markdownTableBodyNone">Less than    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">==   </td><td class="markdownTableBodyNone">Equal to    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">!=   </td><td class="markdownTableBodyNone">Not equal to    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">&lt;&gt;   </td><td class="markdownTableBodyNone">Not equal to    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">&lt;=   </td><td class="markdownTableBodyNone">Less or equal to    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">&gt;=   </td><td class="markdownTableBodyNone">Greater or equal to   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md9"></a>
Conditional jumps</h2>
<p>Sometimes it is useful to skip some block of G-code parts depending on some condition. Conditional jumps are used for this situation.<br  />
 Syntax is:<br  />
 <code>IF</code> condition <code>THEN</code> <br  />
 &#160; ...<br  />
 <code>ELSE</code> <br  />
 &#160; ...<br  />
 <code>END</code> <br  />
 <br  />
 If the <code>condition</code> after the <code>IF</code> keyword is met, the code till <code>ELSE</code> is executed, otherwise the code between <code>ELSE</code> and <code>END</code> is executed.<br  />
 Example: </p><div class="fragment"><div class="line">FOR P21 = 60 TO 45-P22 STEP P22</div>
<div class="line">  IF P24 == 0 THEN</div>
<div class="line">    CALL Cone</div>
<div class="line">  ELSE</div>
<div class="line">    CALL Remove</div>
<div class="line">    P23 = P23 + P24</div>
<div class="line">  END</div>
<div class="line">  P25 = P25 + P26</div>
<div class="line">END</div>
</div><!-- fragment --><p> Conditional jumps can be used to exit from loop, exit from subroutine or continue loop on a next iteration:<br  />
</p><ul>
<li><code>IF</code> condition <code>BREAK</code> - if the <code>condition</code> is valid, exit from the loop and continues program execution after the <code>END</code> keyword of the loop.<br  />
</li>
<li><code>IF</code> condition <code>RETURN</code> - if the <code>condition</code> is valid, exit from subroutine</li>
<li><code>IF</code> condition <code>CONTINUE</code> - if the <code>condition</code> is valid, slip the rest of loop body and goes to the next loop iteration </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
